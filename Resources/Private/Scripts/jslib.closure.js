(function(b){function p(a){return parseInt(a.substring(0,a.indexOf(";",0)),10)}function s(){var a=(new Date).getTime()/1E3;if(Math.round(a-q)>=l)j=""}function t(a){var c=(new Date).getTime()/1E3;c=Math.round(c-q);a.remaining=a.seconds-c;if(!a.flashSet&&a.remaining<=a.flashStart){b(a.element).addClass("flash");a.flashSet=true}else if(a.remaining<1){clearInterval(a.counter);if(u(a)){v();return}}c=Math.floor(a.remaining/60);var d="0"+a.remaining%60;b(a.element).html(c+":"+d.slice(-2))}function u(a){a=
b(a.element).parent(".tx-appointments .typo3-messages .alert.alert-info .alert-message");if(a[0]){var c=a.prev(".tx-appointments .typo3-messages .alert-title"),d=a.parent(".tx-appointments .typo3-messages .alert");if(c[0]&&d[0]){a.html("###TIMER_ZERO###");c.html("###TIMER_ZERO_HEAD###");d.addClass("alert-warning");d.removeClass("alert-info");return true}}return false}function v(){var a=b("#appointments-submit-time",k);if(a[0]){a.val("###RENEW_TIME###");a.addClass("attention")}}function w(){try{return"sessionStorage"in
window&&window.sessionStorage!==null}catch(a){return false}}function m(a,c){sessionStorage.setItem(c+"_"+a.id,a.value)}function x(a){var c=b(".session",a).map(function(){return this.id}).get();for(var d in c){var e=c[d],f=a.id+"_"+e;if(sessionStorage.getItem(f)){e=b("#"+e,a);f=sessionStorage.getItem(f);if(e.hasClass("checkbox")||e.hasClass("radio"))f=="true"?e.prop("checked",true):e.prop("checked",false);else e.val(f)}}}function y(a){var c=[];b(a).attr("required")==="required"?c.push(a):b(a).find('[required="required"]').each(function(d,
e){c.push(e)});return c}function z(a,c,d){var e=b(a.element);if(d&&c===a.enableValue){b(a.required).attr("required","required");e.show()}else{e.hide();b(a.required).removeAttr("required")}}function n(a,c){var d=b(a).val().toLowerCase();a=b(a).data("enable-fields");for(var e in a)z(a[e],d,c)}var q=(new Date).getTime()/1E3,h=b(".tx-appointments"),k=b("form",h);b(".button_delete",h).click(function(a){if(confirm("###DELETE_CONFIRM###"))return true;else{a.stopImmediatePropagation();return false}});var j=
"###WARN_UNLOAD###",l=null,g=null;if("###WARN_ON_LEAVE###"==="1")if(b("form.warnUnload",h)[0])if(j.length){j=j.replace("$1","###WARN_UNLOAD_S1###");g="###WARN_ON_LEAVE_RESPECT_REFRESH###";if(g=="meta-tag"){g=b("meta[http-equiv=REFRESH]");if(g[0])l=p(g.attr("content"))}else if(g=="header")var A=b.ajax({type:"HEAD"}).done(function(){var a=A.getResponseHeader("REFRESH");if(a!=null&&a.length)l=p(a)});window.addEventListener("beforeunload",function(a){l!=null&&s();if(j.length)return a.returnValue=j});
b(".allowUnload",h).on("submit",function(){j=""})}b(".csh",h).hover(function(){appear=true;if(b(this).next().is(".tx-appointments span.tooltip")==false)if(tooltip=b(this).attr("title")){b(this).data("title",tooltip);b(this).after(b('<span class="tooltip" style="display:none;opacity:0;"/>').text(tooltip))}else appear=false;if(appear){b(this).prop("title","");b(this).next().css("display","inline-block").animate({opacity:0.85},150)}},function(){elem=b(this).next();if(elem.is(".tx-appointments span.tooltip")){b(elem).animate({opacity:0},
150,function(){b(this).css("display","none")});b(this).prop("title",b(this).data("title"))}});b(".datepicker",k).datepicker({showOn:"focus",dateFormat:"dd-mm-yy",changeMonth:true,changeYear:true,constrainInput:true,firstDay:1,hideIfNoPrevNext:true,minDate:"-120y",yearRange:"-120y:+10",showOtherMonths:true,selectOtherMonths:true,showWeek:true,dayNamesMin:["###DAY7###","###DAY1###","###DAY2###","###DAY3###","###DAY4###","###DAY5###","###DAY6###"],monthNamesShort:["###MON1###","###MON2###","###MON3###",
"###MON4###","###MON5###","###MON6###","###MON7###","###MON8###","###MON9###","###MON10###","###MON11###","###MON12###"]});b(".datepicker.max-today",k).datepicker("option","maxDate","0");b("span.reservation-timer",h).each(function(){var a={seconds:0,remaining:0,flashStart:60,flashSet:false,counter:null,element:this},c=b(this).html(),d=c.indexOf(":",0),e=parseInt(c.substring(0,d),10);a.seconds=e*60+parseInt(c.substring(d+1),10);if(a.seconds<=a.flashStart){b(this).addClass("flash");a.flashSet=true}a.counter=
setInterval(t,1E3,a)});b("#appointments-select-type",k).change(function(){b("#appointments-submit-type",b(this).parents(".tx-appointments form")).addClass("attention")});b("#appointments-select-date",k).change(function(){b("#appointments-submit-date",b(this).parents(".tx-appointments form")).addClass("attention")});b("#appointments-select-time",k).change(function(){b("#appointments-submit-time",b(this).parents(".tx-appointments form")).addClass("attention")});g=b(".appointment-form.disabled",h);g.addClass("visible");
b(":input",g).prop("disabled",true);w()&&b("form.session",h).each(function(){var a=this.id;x(this);b("textarea.session",this).keyup(function(){m(this,a)});b(".textinput.session",this).keyup(function(){m(this,a)});b(".datepicker.session",this).change(function(){m(this,a)});b(".select.session",this).change(function(){m(this,a)});b(".radio.session",this).change(function(){sessionStorage.setItem(a+"_"+this.id,this.checked);b(this).siblings('.radio.session[name="'+b(this).attr("name")+'"]').each(function(c,
d){sessionStorage.setItem(a+"_"+d.id,d.checked)})});b(".checkbox.session",this).change(function(){sessionStorage.setItem(a+"_"+this.id,this.checked)})});var i={};b(".enablefield",k).each(function(a,c){var d=b(c).attr("class"),e=d.indexOf("eval-f")+6;e=d.slice(e).split("-");d=e[0];e=e[1].split(" ")[0].toLowerCase();var f=null;if(i[d]!==undefined)f=i[d];else{f=b(".formfield-id-"+d,b(c).parents(".tx-appointments form"));if(f[0]){i[d]=f;f.data("enable-fields",{});f.hasClass("radio")?f.change(function(){n(this,
this.checked)}):f.change(function(){n(this,true)})}}if(f[0]){d=b(f[0]).data("enable-fields");d[a]={element:c,enableValue:e,required:y(c)};f.data("enable-fields",d)}});for(var o in i)if(i[o].hasClass("radio")){var r=false;i[o].each(function(a,c){if(this.checked){n(c,true);r=true;return false}});r||n(i[o][0],false)}else i[o].change()})(jQuery);