<html data-namespace-typo3-fluid="true"
	xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers"
	xmlns:a="http://typo3.org/ns/Innologi/Appointments/ViewHelpers">
	
<f:layout name="Default" />

<f:section name="main">

<div class="header">
	<f:link.action title="{f:translate(key:'link.title.appointment_new')}" action="new1" addQueryString="TRUE" class="button_new"><f:translate key="tx_appointments_list.appointment_new" /></f:link.action>
	<f:if condition="{f:count(subject: unfinishedAppointments)} > 0">
		<f:render partial="Appointment/Unfinished" arguments="{appointments: unfinishedAppointments}" />
	</f:if>
</div>

<f:if condition="{f:count(subject: appointments)} > 0">
<table class="appointmentList" summary="{f:translate(key:'tx_appointments_list.summary_list')}">
	<caption><f:translate key="tx_appointments_list.caption_list" /></caption>
	<tr>
		<th scope="col"><f:translate key="property.appointment" /></th>
		<th scope="col">&nbsp;</th>
		<th scope="col">&nbsp;</th>
	</tr>
	
	<f:for each="{appointments}" as="appointment">
		<tr>
			<td>
				<f:link.action title="{f:translate(key:'link.title.appointment_show')}" action="show" arguments="{appointment : appointment}" addQueryString="TRUE" class="link_appointment">
					<f:format.date format="d-m-Y, H:i">{appointment.beginTime}</f:format.date>:
					<f:format.htmlentities>{appointment.type.name}</f:format.htmlentities>
				</f:link.action>
			</td>
			<f:if condition="{a:appointment.isMutable(appointment:appointment, time:now)}">
				<f:then>
					<td><f:link.action title="{f:translate(key:'link.title.appointment_edit')}" action="edit" arguments="{appointment : appointment}" addQueryString="TRUE" class="button_edit"><f:translate key="tx_appointments_list.appointment_edit" /></f:link.action></td>
					<td><f:form enctype="multipart/form-data" method="post" action="delete" object="{appointment}" objectName="appointment" class="delete-form one-button-form" absolute="TRUE">
						<fieldset>
							<f:form.hidden name="stoken" value="{a:csrf(uid:appointment.uid)}" />
							<f:form.button type="submit" name="submit" class="button_delete"><f:translate key="tx_appointments_list.appointment_delete" /></f:form.button>
						</fieldset>
					</f:form></td>
				</f:then>
				<f:else>
					<td colspan="2">&nbsp;</td>
				</f:else>
			</f:if>
		</tr>
	</f:for>
</table>
</f:if>
</f:section>

</html>